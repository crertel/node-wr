<!DOCTYPE html>
<html>
  <head>
    <title>Water Rower</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <h1> Water Rower </h1>
    <button id="reset_button"> Reset </button>
    <div>
      <ul id="stats">
      </ul>
    </div>

    <script>
      var ws = new WebSocket("ws://" + location.host);
      var $resetButton = document.getElementById("reset_button");
      var $stats = document.getElementById("stats");

      $resetButton.onclick = function postReset() {
        var msg = { msg: "reset rower"};
        ws.send( JSON.stringify(msg) );
      };

      ws.onmessage = function(msg) {
        var readings = JSON.parse(msg.data);
        $stats.innerHTML = "";
        Object.keys(readings).forEach(function (k) {
          var reading = readings[k];
          var $reading = document.createElement('li');
          $reading.innerHTML = "<strong>" + k + "</strong> " + reading;
          $stats.appendChild($reading);
        });
      }
    </script>
  </body>
</html>
